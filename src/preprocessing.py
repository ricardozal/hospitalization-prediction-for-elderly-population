from typing import List, Tuple, Dict
import pandas as pd

def preprocess_dataframe(df : pd.DataFrame) -> pd.DataFrame:
    to_int32=['rXagey', 'rXmrct', 'rXdrinkd', 'rXdrinkn', 'rXbinged', 'rXcage', 'rXfallnum', 'rXmobila', 'rXsmokef', 'rXstrtsmok', 'rXquitsmok', 'rXdoctim1y', 'rXhspnit1y', 'rXdentim1y', 'rXhenum', 'rXverbf', 'rXvscan', 'rXidraw2', 'rXidraw1', 'rXddraw2', 'rXddraw1', 'rXdlrc8', 'rXser7', 'hXchild', 'hXdau', 'hXson', 'hXdchild', 'hXgrchild', 'rXmomage', 'rXdadage', 'rXdecsib', 'raevbrn', 'rXlivsib', 'rXjlasty', 'hXgapcarehr', 'hXgccarehr_m', 'hXrcchorehr', 'rXrccaren', 'rXrccaredpm', 'rXrccaredpmm', 'rXrccarehr', 'rXrccarehrm', 'rXrfcaredpm', 'rXrfcaredpmm', 'rXrfcarehr', 'rXrfcarehrm', 'rXrpfcaredpm', 'rXrpfcaredpmm', 'rXrpfcarehr', 'rXrpfcarehrm', 'rXrrcaredpm', 'rXrrcaredpmm', 'rXrrcarehr', 'rXrrcarehrm', 'rXrscaredpm', 'rXrscarehr', 'rXcesd_m']

    categories = {
        'hXcpl' : {0: 'NO', 1: 'YES'},
        'hXrural' : {0: 'URBAN', 1: 'RURAL'},
        'ragender' : {1: 'MAN', 2: 'WOMAN'},
        'raindlang' : {0: 'NO', 1: 'YES'},
        'raedisced' : {0: 'No Education', 1: 'Primary', 2: 'Low secondary', 3: 'Upper secondary', 5: 'First stage tertiary education', 6: 'Second stage tertiary education'},
        'rXmstat' : {1: 'married', 3: 'partnered', 4: 'separated', 5: 'divorced', 7: 'widowed', 8: 'single'},
        'rXwalkra' : {0: 'NO', 1: 'YES'},
        'rXbatha' : {0: 'NO', 1: 'YES'},
        'rXeata' : {0: 'NO', 1: 'YES'},
        'rXtoilta' : {0: 'NO', 1: 'YES'},
        'rXarthlmt' : {0: 'NO', 1: 'YES'},
        'rXhibpe' : {0: 'NO', 1: 'YES'},
        'rXdiabe' : {0: 'NO', 1: 'YES'},
        'rXcancre' : {0: 'NO', 1: 'YES'},
        'rXrespe' : {0: 'NO', 1: 'YES'},
        'rXhrtatte' : {0: 'NO', 1: 'YES'},
        'rXhearte' : {0: 'NO', 1: 'YES'},
        'rXstroke' : {0: 'NO', 1: 'YES'},
        'rXarthre' : {0: 'NO', 1: 'YES'},
        'rXdrink' : {0: 'NO', 1: 'YES'},
        'rXdrinkb' : {0: 'NO', 1: 'YES'},
        'rXdrinkcut' : {0: 'NO', 1: 'YES'},
        'rXdrinkcr' : {0: 'NO', 1: 'YES'},
        'rXdrinkbd' : {0: 'NO', 1: 'YES'},
        'rXdrinknr' : {0: 'NO', 1: 'YES'},
        'rXcholst' : {0: 'NO', 1: 'YES'},
        'rXflusht' : {0: 'NO', 1: 'YES'},
        'rXbreast' : {0: 'NO', 1: 'YES'},
        'rXmammog' : {0: 'NO', 1: 'YES'},
        'rXpapsm' : {0: 'NO', 1: 'YES'},
        'rXprost' : {0: 'NO', 1: 'YES'},
        'rXrxhibp' : {0: 'NO', 1: 'YES'},
        'rXrxdiabi' : {0: 'NO', 1: 'YES'},
        'rXrxdiab' : {0: 'NO', 1: 'YES'},
        'rXcncrchem' : {0: 'NO', 1: 'YES'},
        'rXcncrsurg' : {0: 'NO', 1: 'YES'},
        'rXcncrradn' : {0: 'NO', 1: 'YES'},
        'rXcncrmeds' : {0: 'NO', 1: 'YES'},
        'rXcncrothr' : {0: 'NO', 1: 'YES'},
        'rXrxresp' : {0: 'NO', 1: 'YES'},
        'rXrxhrtat' : {0: 'NO', 1: 'YES'},
        'rXrxstrok' : {0: 'NO', 1: 'YES'},
        'rXrxarthr' : {0: 'NO', 1: 'YES'},
        'rXdress' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXwalkr' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXbath' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXeat' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXbed' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXtoilt' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXwalks' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXjog' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXwalk1' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXsit' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXchair' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXclims' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXclim1' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXstoop' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXlift' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXdime' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXarms' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXpush' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXswell' : {0: 'NO', 1: 'YES'},
        'rXbreath_m' : {0: 'NO', 1: 'YES'},
        'rXwheeze' : {0: 'NO', 1: 'YES'},
        'rXfatigue' : {0: 'NO', 1: 'YES'},
        'rXsight' : {1:'Excellent', 2: 'Very good', 3: 'Good', 4: 'Fair', 5: 'Poor', 6: 'Legally blind'},
        'rXglasses' : {0: 'NO', 1: 'YES'},
        'rXhearing' : {1:'Excellent', 2: 'Very good', 3: 'Good', 4: 'Fair', 5: 'Poor', 6: 'Legally deaf'},
        'rXhearaid' : {0: 'NO', 1: 'YES'},
        'rXshlt' : {1:'Excellent', 2: 'Very good', 3: 'Good', 4: 'Fair', 5: 'Poor'},
        'rXhltc' : { 1: 'Much better', 2: 'Somewhat better', 3: 'More or less the same', 4: 'Somewhat worse', 5: 'Much worse'},
        'rXfall' : {0: 'NO', 1: 'YES'},
        'rXhip50e' : {0: 'NO', 1: 'YES'},
        'rXhip_m' : {0: 'NO', 1: 'YES'},
        'rXhip' : {0: 'NO', 1: 'YES'},
        'rXlgmusaa' : {0: 'NO', 1: 'YES'},
        'rXuppermoba' : {0: 'NO', 1: 'YES'},
        'rXlowermoba' : {0: 'NO', 1: 'YES'},
        'rXmoney' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXmeds' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXshop' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXmeals' : { 0: 'No difficulty', 1: 'some difficulty', 2: 'Cannot do', 9: 'Do not do'},
        'rXvigact' : {0: 'I didnt', 1: 'I did'},
        'rXurina2y' : {0: 'NO', 1: 'YES'},
        'rXurinurg2y' : {0: 'NO', 1: 'YES'},
        'rXurincgh2y' : {0: 'NO', 1: 'YES'},
        'rXpainfr' : {0: 'NO', 1: 'YES'},
        'rXpainlv' : {0:'No pain', 1:'Mild', 2:'Moderate', 3:'Severe'},
        'rXpaina' : {0: 'NO', 1: 'YES'},
        'rXsmokev' : {0: 'NO', 1: 'YES'},
        'rXsmoken' : {0: 'NO', 1: 'YES'},
        'rXdoctor1y' : {0: 'NO', 1: 'YES'},
        'rXcovr_m' : {0: 'NO', 1: 'YES'},
        'rXcovs_m' : {0: 'NO', 1: 'YES'},
        'rXoutpt1y' : {0: 'NO', 1: 'YES'},
        'rXdentst1y' : {0: 'NO', 1: 'YES'},
        'rXhigov' : {0: 'NO', 1: 'YES'},
        'rXhipriv' : {0: 'NO', 1: 'YES'},
        'rXbwc20' : {2: 'First Try', 1: 'Second Try', 0: 'Not Successful'},
        'rXslfmem' : {1:'Excellent', 2: 'Very good', 3: 'Good', 4: 'Fair', 5: 'Poor memory'},
        'rXpstmem' : {1:'Better', 2: 'About the same', 3: 'Worse'},
        'rXnovisual' : {0: 'NO', 1: 'YES'},
        'rXnopencil' : {0: 'NO', 1: 'YES'},
        'hXcoresd' : {0: 'NO', 1: 'YES'},
        'hXfcany' : {0: 'NO', 1: 'YES'},
        'hXkcnt' : {0: 'NO', 1: 'YES'},
        'hXlvnear' : {0: 'NO', 1: 'YES'},
        'hXtcany' : {0: 'NO', 1: 'YES'},
        'rXmomliv' : {0: 'NO', 1: 'YES'},
        'rXdadliv' : {0: 'NO', 1: 'YES'},
        'rameduc_m' : {1: 'No education', 2: 'Some primary', 3 : 'Primary', 4: 'More than primary'},
        'rafeduc_m' : {1: 'No education', 2: 'Some primary', 3 : 'Primary', 4: 'More than primary'},
        'rXtpany' : {0: 'NO', 1: 'YES'},
        'rXsocact_m' : {1: 'Almost every day', 2: 'Four times/week', 3: 'Two or three times/week', 4: 'Once a week', 5: 'Four or more times a month', 6: 'Two or three times a month', 7: 'Once a month', 8: 'Almost never/sporadic', 9: 'Never'},
        'rXrelgwk' : {0: 'NO', 1: 'YES'},
        'rXrelgimp' : {1: 'Very important', 2: 'Somewhat important', 3: 'Not important'},
        'rXrfcnt' : {0: 'NO', 1: 'YES'},
        'rXlivpar' : {0: 'None living', 1: 'Single parent alive', 2: 'Both parents alive'},
        'rXunemp' : {0: 'NO', 1: 'YES'},
        'rXjrsleft' : { 1: 'Retired', 2: 'Fired', 3: 'Laid off', 4: 'Health reasons', 5: 'Family reasons', 6: 'New job', 7: 'Quit', 8: 'Other reason'},
        'hXgapcare' : {0: 'NO', 1: 'YES'},
        'hXgccare_m' : {0: 'NO', 1: 'YES'},
        'hXrcchore' : {0: 'NO', 1: 'YES'},
        'hXrcchorenf' : {1: 'More than enough', 2: 'Enough', 3: 'Not enough'},
        'rXwalkre' : {0: 'NO', 1: 'YES'},
        'rXbede' : {0: 'NO', 1: 'YES'},
        'rXftrhlp' : {0: 'NO', 1: 'YES'},
        'rXgcaresck' : {0: 'NO', 1: 'YES'},
        'rXracaany' : {0: 'NO', 1: 'YES'},
        'rXracany' : {0: 'NO', 1: 'YES'},
        'rXrafaany' : {0: 'NO', 1: 'YES'},
        'rXrcaany' : {0: 'NO', 1: 'YES'},
        'rXrccare' : {0: 'NO', 1: 'YES'},
        'rXrfaany' : {0: 'NO', 1: 'YES'},
        'rXrfcare' : {0: 'NO', 1: 'YES'},
        'rXrrcare' : {0: 'NO', 1: 'YES'},
        'rXrscare' : {0: 'NO', 1: 'YES'},
        'rXsustdfe_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXsrely_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXsopenup_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXsletdow_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'hXchdeathe' : {0: 'NO', 1: 'YES'},
        'rXfustdfe_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXfrely_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXfopenup_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXfletdow_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXkustdfe_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXkrely_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXkopenup_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXkletdow_m' : {1: 'A lot', 2: 'Little', 3: 'Not at all'},
        'rXdepres' : {0: 'NO', 1: 'YES'},
        'rXeffort' : {0: 'NO', 1: 'YES'},
        'rXsleepr' : {0: 'NO', 1: 'YES'},
        'rXwhappy' : {0: 'NO', 1: 'YES'},
        'rXflone' : {0: 'NO', 1: 'YES'},
        'rXenlife' : {0: 'NO', 1: 'YES'},
        'rXfsad' : {0: 'NO', 1: 'YES'},
        'rXftired' : {0: 'NO', 1: 'YES'},
        'rXenerg' : {0: 'NO', 1: 'YES'},
        'rXlideal3' : {1: 'Disagree', 2: 'Neutral', 3: 'Agree'},
        'rXlexcl3' : {1: 'Disagree', 2: 'Neutral', 3: 'Agree'},
        'rXlstsf3' : {1: 'Disagree', 2: 'Neutral', 3: 'Agree'},
        'rXlimptt3' : {1: 'Disagree', 2: 'Neutral', 3: 'Agree'},
        'rXlchnot3' : {1: 'Disagree', 2: 'Neutral', 3: 'Agree'},
        'rXlsatsc3' : {1: 'Disagree', 2: 'Neutral', 3: 'Agree'}	
    }

    # Convert specified columns to int32
    for col in to_int32:
        if col in df.columns:
            # Convert column to numeric with errors='coerce'
            df[col] = pd.to_numeric(df[col], errors='coerce').astype('Int32')

    # Convert columns to categorical type based on the dictionaries
    for col, mapping in categories.items():
        df[col] = df[col].map(mapping).astype('category')

    return df